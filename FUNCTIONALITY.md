# Tic-tac 仓库功能详解

## 项目概述

**Tic-tac** 是一个专门用于求解三体核物理系统Faddeev方程的高性能科学计算程序。该项目实现了完整的三体散射理论计算框架，能够处理核子-氘核散射、三核子束缚态以及相关的核物理观测量计算。

---

## 🎯 核心功能模块

### 1. Faddeev方程求解器 (`src/core/faddeev_solver/`)

**主要功能：**
- 求解三体系统的耦合Faddeev方程组
- 支持Padé近似迭代方法和稠密直接求解器
- 处理弹性和非弹性散射过程

**核心算法：**
```cpp
// Faddeev方程: ψᵢ = φᵢ + G₀(E) Tᵢ (ψⱼ + ψₖ)
// 线性化形式: (I - AG)U = A
// 其中 A = C†PVC, G为格林函数
```

**技术特点：**
- 稀疏矩阵优化（COO/CSR格式）
- OpenMP并行化
- 内存高效的矩阵向量运算
- 数值稳定的迭代求解

### 2. 状态空间构建 (`src/core/state_space/`)

**偏波态空间构建** (`make_pw_symm_states.*`)
- 根据角动量和同位旋量子数构建三体系统的偏波态
- 支持不同的角动量截断策略
- 自动处理对称性约束

**波包离散化** (`make_wp_states.*`)
- 生成动量空间的波包基组
- 支持Chebyshev和等间距网格
- 可配置的网格密度和分布

**强弱波包基组** (`make_swp_states.*`)
- 通过二体哈密顿量对角化构建SWP基
- 自动分离束缚态和散射态
- 优化的基组变换矩阵

**置换算符矩阵** (`make_permutation_matrix.*`)
- 计算三体系统的置换算符P₁₂₃
- 处理全同粒子的反对称化
- 稀疏存储大型置换矩阵

### 3. 势能计算模块 (`src/core/potential/`)

**势能矩阵构建** (`make_potential_matrix.*`)
- 在波包基组中计算二体相互作用势矩阵
- 支持耦合和非耦合分波道
- 高效的角动量积分算法

**支持的势能模型：**
- 手征有效场理论势（ChEFT）: LO, N2LOopt, N3LO Idaho
- 现象学势能：Nijmegen, Malfliet-Tjon
- 单π交换势（OPEP）
- 可扩展的势能接口框架

### 4. 格林函数计算 (`src/core/resolvent/`)

**三体格林函数** (`make_resolvent.*`)
- 计算自由三体传播子G₀(E)
- 处理复能量平面的奇点
- 在SWP基组中的高效表示

**技术实现：**
- 动能算符的精确对角化
- 数值稳定的能量积分
- 内存优化的存储格式

---

## 🔬 物理应用能力

### 1. 核子-氘核散射

**计算内容：**
- n+d和p+d弹性散射截面
- 微分截面和总截面
- 极化观测量（分析能力、极化度）
- 相移和相位提取

**能量范围：**
- 低能阈值散射（0.1-5 MeV）
- 中能散射（5-50 MeV）
- 高能区域的预测（50-200 MeV）

### 2. 三核子束缚态

**研究对象：**
- 氚核（³H）束缚能和波函数
- ³He核的电磁性质
- 三体束缚态的密度分布

**计算精度：**
- 束缚能精度：~0.1 MeV
- 均方根半径：~1%误差
- 磁偶极矩等静态性质

### 3. 破裂反应

**反应类型：**
- (d,p)和(d,n)转移反应
- 三体破裂过程d+N→N+N+N
- 连续谱的角分布计算

**物理量：**
- 双微分截面
- 最终态粒子关联
- 动量分布和能谱

---

## ⚙️ 数值方法和算法

### 1. 波包离散化方法（WPCD）

**核心思想：**
将连续的动量空间离散化为有限个波包，每个波包在一定动量区间内具有良好的局域性。

**优势：**
- 避免传统格点方法的边界效应
- 自然处理散射边界条件
- 高效的稀疏矩阵结构

**实现特点：**
- Chebyshev-Gauss-Lobatto网格点
- 自适应的波包宽度调节
- 并行化的矩阵组装

### 2. 稀疏矩阵技术

**存储格式：**
- COO（坐标格式）用于矩阵组装
- CSR（压缩稀疏行）用于矩阵向量乘法
- 动态内存管理避免不必要的零元素

**优化策略：**
- 预估非零元素个数
- 分块存储减少缓存缺失
- 向量化的BLAS操作

### 3. 并行计算架构

**并行层次：**
- 粗粒度：不同能量点并行计算
- 中粒度：矩阵乘法的OpenMP并行
- 细粒度：SIMD向量化操作

**负载均衡：**
- 动态任务调度
- 内存带宽优化
- NUMA感知的内存分配
